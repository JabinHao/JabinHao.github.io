<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png"><link rel="icon" type="image/png" href="/img/site.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="Jipeng Hao 的个人博客"><meta name="author" content="Martentite"><meta name="keywords" content="java, python, blog"><title>Chapter5后台管理 — 菜单维护 - 山那边的小木屋</title><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/prism/1.21.0/themes/prism-okaidia.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_pf9vaxs7x7b.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="山那边的小木屋" type="application/atom+xml">
</head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>Jacob</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> 友链</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" href="javascript:">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner intro-2" id="background" parallax="true" style="background:url(/img/post/banner/mandao.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="container page-header text-center fade-in-up"><span class="h2" id="subtitle"></span><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> Martentite </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2021-01-09 01:16" pubdate>2021年1月9日 凌晨</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 7.7k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 131 分钟</span></div></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto" id="post"><h1 style="display:none">Chapter5后台管理 — 菜单维护</h1><div class="markdown-body" id="post-body"><h2 id="5-1-页面显示树形结构"><a href="#5-1-页面显示树形结构" class="headerlink" title="5.1 页面显示树形结构"></a>5.1 页面显示树形结构</h2><h3 id="5-1-1-树形结构"><a href="#5-1-1-树形结构" class="headerlink" title="5.1.1 树形结构"></a>5.1.1 树形结构</h3><ol><li>树形结构示意<br><img src="https://raw.githubusercontent.com/JabinHao/mihs/master/blog/crowd_funding/5-1-5.png" srcset="/img/loading.gif"><ul><li>约定：整个树形结构节点的层次最多只能有 3 级。</li></ul></li><li>数据库中节点关联：通过pid字段关联到父节点id</li><li>Java中树形结构<ul><li>实现：在 Menu 类中使用 List<menu>children 属性存储当前节点的子节点</menu></li><li>属性（配合zTree）<ul><li>pid：父节点</li><li>name：节点名称</li><li>icon：节点图标</li><li>open：节点是否默认打开</li><li>url：节点跳转位置</li></ul></li></ul></li><li>不同级别节点规则<ul><li>level0：根节点<ul><li>添加子节点</li></ul></li><li>level1：分支节点<ul><li>修改</li><li>添加子节点</li><li>删除：有子节点时允许</li></ul></li><li>level2：叶节点<ul><li>修改</li><li>删除</li></ul></li></ul></li></ol><h3 id="5-1-2-目标思路"><a href="#5-1-2-目标思路" class="headerlink" title="5.1.2 目标思路"></a>5.1.2 目标思路</h3><ol><li>目标：将数据库中查询得到的数据到页面上显示出来</li><li>思路：<br>数据库查询全部 -&gt; Java对象组装 -&gt; 页面上使用 zTree 显示</li></ol><h3 id="5-1-3-准备工作"><a href="#5-1-3-准备工作" class="headerlink" title="5.1.3 准备工作"></a>5.1.3 准备工作</h3><ol><li>数据库表<pre class="language-mysql" data-language="mysql"><code class="language-mysql"># 创建菜单表
DROP TABLE IF EXISTS t_menu;
CREATE TABLE t_menu
(
    id      INT(11) NOT NULL AUTO_INCREMENT,
    pid     INT(11),
    name    VARCHAR(200),
    url     VARCHAR(200),
    icon    VARCHAR(200),
    PRIMARY KEY (id)
);</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># 插入数据
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;1&#39;,NULL,&#39;系统权限菜单&#39;,&#39;glyphicon glyphicon-th-list&#39;,NULL);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;2&#39;,&#39;1&#39;,&#39; 控 制 面 板 &#39;,&#39;glyphicon glyphicon-dashboard&#39;,&#39;main.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;3&#39;,&#39;1&#39;,&#39;权限管理&#39;,&#39;glyphicon glyphicon glyphicon-tasks&#39;,NULL);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;4&#39;,&#39;3&#39;,&#39; 用 户 维 护 &#39;,&#39;glyphicon glyphicon-user&#39;,&#39;user&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;5&#39;,&#39;3&#39;,&#39; 角 色 维 护 &#39;,&#39;glyphicon glyphicon-king&#39;,&#39;role&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;6&#39;,&#39;3&#39;,&#39; 菜 单 维 护 &#39;,&#39;glyphicon glyphicon-lock&#39;,&#39;permission&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;7&#39;,&#39;1&#39;,&#39; 业 务 审 核 &#39;,&#39;glyphicon glyphicon-ok&#39;,NULL);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;8&#39;,&#39;7&#39;,&#39; 实 名 认 证 审 核 &#39;,&#39;glyphicon glyphicon-check&#39;,&#39;auth_cert&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;9&#39;,&#39;7&#39;,&#39; 广 告 审 核 &#39;,&#39;glyphicon glyphicon-check&#39;,&#39;auth_adv&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;10&#39;,&#39;7&#39;,&#39; 项 目 审 核 &#39;,&#39;glyphicon glyphicon-check&#39;,&#39;auth_project&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;11&#39;,&#39;1&#39;,&#39; 业 务 管 理 &#39;,&#39;glyphicon glyphicon-th-large&#39;,NULL);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;12&#39;,&#39;11&#39;,&#39; 资 质 维 护 &#39;,&#39;glyphicon glyphicon-picture&#39;,&#39;cert&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;13&#39;,&#39;11&#39;,&#39; 分 类 管 理 &#39;,&#39;glyphicon glyphicon-equalizer&#39;,&#39;certtype&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;14&#39;,&#39;11&#39;,&#39; 流 程 管 理 &#39;,&#39;glyphicon glyphicon-random&#39;,&#39;process&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;15&#39;,&#39;11&#39;,&#39; 广 告 管 理 &#39;,&#39;glyphicon glyphicon-hdd&#39;,&#39;advert&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;16&#39;,&#39;11&#39;,&#39; 消 息 模 板 &#39;,&#39;glyphicon glyphicon-comment&#39;,&#39;message&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;17&#39;,&#39;11&#39;,&#39; 项 目 分 类 &#39;,&#39;glyphicon glyphicon-list&#39;,&#39;projectType&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;18&#39;,&#39;11&#39;,&#39; 项 目 标 签 &#39;,&#39;glyphicon glyphicon-tags&#39;,&#39;tag&#x2F;index.htm&#39;);
INSERT INTO &#96;t_menu&#96; (&#96;id&#96;, &#96;pid&#96;, &#96;name&#96;, &#96;icon&#96;, &#96;url&#96;) VALUES (&#39;19&#39;,&#39;1&#39;,&#39; 参 数 管 理 &#39;,&#39;glyphicon glyphicon-list-alt&#39;,&#39;param&#x2F;index.htm&#39;);</code></pre></li><li>逆向工程<ul><li>修改generatorConfig.xml<pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!--  数据库表名字和我们的 entity 类对应的映射指定 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">tableName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_menu<span class="token punctuation">"</span></span> <span class="token attr-name">domainObjectName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Menu<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre></li><li>mybatis-generator:generate</li></ul></li><li>给Menu类增加属性、getter、setter等<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Menu</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">// 主键</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

    <span class="token comment">// 父节点id</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> pid<span class="token punctuation">;</span>

    <span class="token comment">// 节点名称</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token comment">// 节点附带url地址，点击菜单项时要跳转的地址</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>

    <span class="token comment">// 节点图标样式</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> icon<span class="token punctuation">;</span>

    <span class="token comment">// 存储子节点的集合，初始化以避免空指针异常</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> children <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 控制节点是否默认展开，设置为true表示默认打开</span>
    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> <span class="token keyword">open</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getPid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> pid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPid</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> pid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pid <span class="token operator">=</span> pid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> name<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> url<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> url<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getIcon</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> icon<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setIcon</span><span class="token punctuation">(</span><span class="token class-name">String</span> icon<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>icon <span class="token operator">=</span> icon <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> icon<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> <span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> children<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">getOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">open</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setChildren</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> children<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>children <span class="token operator">=</span> children<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOpen</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span> <span class="token keyword">open</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token keyword">open</span> <span class="token operator">=</span> <span class="token keyword">open</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">Menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">Menu</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span> <span class="token class-name">Integer</span> pid<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> url<span class="token punctuation">,</span> <span class="token class-name">String</span> icon<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> children<span class="token punctuation">,</span> <span class="token class-name">Boolean</span> <span class="token keyword">open</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pid <span class="token operator">=</span> pid<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>icon <span class="token operator">=</span> icon<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>children <span class="token operator">=</span> children<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token keyword">open</span> <span class="token operator">=</span> <span class="token keyword">open</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"Menu&#123;"</span> <span class="token operator">+</span>
                <span class="token string">"id="</span> <span class="token operator">+</span> id <span class="token operator">+</span>
                <span class="token string">", pid="</span> <span class="token operator">+</span> pid <span class="token operator">+</span>
                <span class="token string">", name='"</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">", url='"</span> <span class="token operator">+</span> url <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">", icon='"</span> <span class="token operator">+</span> icon <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">", children="</span> <span class="token operator">+</span> children <span class="token operator">+</span>
                <span class="token string">", open="</span> <span class="token operator">+</span> <span class="token keyword">open</span> <span class="token operator">+</span>
                <span class="token string">'&#125;'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre></li><li>资源归位：将生成的四个类移动到相应的模块中</li><li>新建service<br>MenuService<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MenuService</span> <span class="token punctuation">&#123;</span>
    
<span class="token punctuation">&#125;</span></code></pre>MenuServiceImpl<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MenuServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">MenuService</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MenuMapper</span> menuMapper<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre></li><li>handler<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MenuHandler</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MenuService</span> menuService<span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span></code></pre></li></ol><h3 id="5-1-4-代码"><a href="#5-1-4-代码" class="headerlink" title="5.1.4 代码"></a>5.1.4 代码</h3><ol><li><p>handler</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/menu/get/whole/tree.do"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResultEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> <span class="token function">getWholeTreeNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">// 1.查询全部的Menu对象</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> menuList <span class="token operator">=</span> menuService<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2.声明一个变量来存储找到的根节点</span>
    <span class="token class-name">Menu</span> root <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

     <span class="token comment">// 3.创建 Map 对象用来存储 id 和 Menu 对象的对应关系便于查找父节点</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> menuMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">// 4.遍历 menuList 填充 menuMap</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Menu</span> menu<span class="token operator">:</span> menuList<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">Integer</span> id <span class="token operator">=</span> menu<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        menuMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// 5.再次遍历 menuList 查找根节点、组装父子节点</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Menu</span> menu<span class="token operator">:</span> menuList<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token comment">// 5.1 获取当前对象pid</span>
        <span class="token class-name">Integer</span> pid <span class="token operator">=</span> menu<span class="token punctuation">.</span><span class="token function">getPid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 5.2 检查pid是否为null</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pid <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">// 将当前对象赋给root</span>
            root <span class="token operator">=</span> menu<span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">// 5.3 如果pid不为null，说明当前节点有父节点，找到父节点就可以进行组装</span>
        menuMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>pid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResultEntity</span><span class="token punctuation">.</span><span class="token function">successWithData</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre></li><li><p>service</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> menuList <span class="token operator">=</span> menuMapper<span class="token punctuation">.</span><span class="token function">selectByExample</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MenuExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> menuList<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre></li><li><p>mvc配置文件</p><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>view-controller</span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/menu/to/page.do<span class="token punctuation">"</span></span> <span class="token attr-name">view-name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu-page<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></code></pre></li><li><p>新建menu-page.jsp</p><pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;%@ page contentType&#x3D;&quot;text&#x2F;html;charset&#x3D;UTF-8&quot; language&#x3D;&quot;java&quot; %&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang&#x3D;&quot;zh-CN&quot;&gt;
&lt;%@include file&#x3D;&quot;include-head.jsp&quot; %&gt;
&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;ztree&#x2F;zTreeStyle.css&quot;&#x2F;&gt;
&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;ztree&#x2F;jquery.ztree.all-3.5.min.js&quot;&gt;&lt;&#x2F;script&gt;
&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;
    $(function ()&#123;

        &#x2F;&#x2F; 1.创建JSON对象用于存储对zTree所做的设置
        var setting &#x3D; &#123;&#125;;

        &#x2F;&#x2F; 2.准备生成树形结构的JSON数据
        var zNodes &#x3D;[
            &#123; name:&quot;父节点1 - 展开&quot;, open:true,
                children: [
                    &#123; name:&quot;父节点11 - 折叠&quot;,
                        children: [
                            &#123; name:&quot;叶子节点111&quot;&#125;,
                            &#123; name:&quot;叶子节点112&quot;&#125;,
                            &#123; name:&quot;叶子节点113&quot;&#125;,
                            &#123; name:&quot;叶子节点114&quot;&#125;
                        ]&#125;,
                    &#123; name:&quot;父节点12 - 折叠&quot;,
                        children: [
                            &#123; name:&quot;叶子节点121&quot;&#125;,
                            &#123; name:&quot;叶子节点122&quot;&#125;,
                            &#123; name:&quot;叶子节点123&quot;&#125;,
                            &#123; name:&quot;叶子节点124&quot;&#125;
                        ]&#125;,
                    &#123; name:&quot;父节点13 - 没有子节点&quot;, isParent:true&#125;
                ]&#125;,
            &#123; name:&quot;父节点2 - 折叠&quot;,
                children: [
                    &#123; name:&quot;父节点21 - 展开&quot;, open:true,
                        children: [
                            &#123; name:&quot;叶子节点211&quot;&#125;,
                            &#123; name:&quot;叶子节点212&quot;&#125;,
                            &#123; name:&quot;叶子节点213&quot;&#125;,
                            &#123; name:&quot;叶子节点214&quot;&#125;
                        ]&#125;,
                    &#123; name:&quot;父节点22 - 折叠&quot;,
                        children: [
                            &#123; name:&quot;叶子节点221&quot;&#125;,
                            &#123; name:&quot;叶子节点222&quot;&#125;,
                            &#123; name:&quot;叶子节点223&quot;&#125;,
                            &#123; name:&quot;叶子节点224&quot;&#125;
                        ]&#125;,
                    &#123; name:&quot;父节点23 - 折叠&quot;,
                        children: [
                            &#123; name:&quot;叶子节点231&quot;&#125;,
                            &#123; name:&quot;叶子节点232&quot;&#125;,
                            &#123; name:&quot;叶子节点233&quot;&#125;,
                            &#123; name:&quot;叶子节点234&quot;&#125;
                        ]&#125;
                ]&#125;,
            &#123; name:&quot;父节点3 - 没有子节点&quot;, isParent:true&#125;
        ];

        &#x2F;&#x2F; 3.初始化树形结构
        $.fn.zTree.init($(&quot;#treeDemo&quot;), setting, zNodes);


    &#125;)
&lt;&#x2F;script&gt;

&lt;body&gt;
&lt;%@include file&#x3D;&quot;include-nav.jsp&quot; %&gt;
&lt;div class&#x3D;&quot;container-fluid&quot;&gt;
    &lt;div class&#x3D;&quot;row&quot;&gt;
        &lt;%@include file&#x3D;&quot;include-sidebar.jsp&quot; %&gt;
        &lt;div class&#x3D;&quot;col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main&quot;&gt;

            &lt;div class&#x3D;&quot;panel panel-default&quot;&gt;
                &lt;div class&#x3D;&quot;panel-heading&quot;&gt;&lt;i class&#x3D;&quot;glyphicon glyphicon-th-list&quot;&gt;&lt;&#x2F;i&gt; 权限菜单列表 &lt;div style&#x3D;&quot;float:right;cursor:pointer;&quot; data-toggle&#x3D;&quot;modal&quot; data-target&#x3D;&quot;#myModal&quot;&gt;&lt;i class&#x3D;&quot;glyphicon glyphicon-question-sign&quot;&gt;&lt;&#x2F;i&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;
                &lt;div class&#x3D;&quot;panel-body&quot;&gt;
                    &lt;!-- zTree动态生成的标签所依附的静态节点 --&gt;
                    &lt;ul id&#x3D;&quot;treeDemo&quot; class&#x3D;&quot;ztree&quot;&gt;&lt;&#x2F;ul&gt;
                &lt;&#x2F;div&gt;
            &lt;&#x2F;div&gt;
        &lt;&#x2F;div&gt;
    &lt;&#x2F;div&gt;
&lt;&#x2F;div&gt;
&lt;&#x2F;body&gt;
&lt;&#x2F;html&gt;</code></pre></li><li><p>修改include-sidebar.jsp</p><pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;a href&#x3D;&quot;menu&#x2F;to&#x2F;page.do&quot;&gt;&lt;i class&#x3D;&quot;glyphicon glyphicon-lock&quot;&gt;&lt;&#x2F;i&gt; 菜单维护&lt;&#x2F;a&gt;</code></pre></li><li><p>修改menu-page.jsp的js代码</p><pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;
    $(function ()&#123;
        &#x2F;&#x2F; 1.准备生成树形结构的JSON数据，数据来源是发送Ajax请求得到
        $.ajax(&#123;
            url: &quot;menu&#x2F;get&#x2F;whole&#x2F;tree.do&quot;,
            type: &quot;post&quot;,
            dataType: &quot;json&quot;,
            success: function (resp) &#123;
                var result &#x3D; resp.result;
                if (result &#x3D;&#x3D;&#x3D; &quot;SUCCESS&quot;) &#123;

                    &#x2F;&#x2F; 2.创建json对象用于存储对zTree所做的设置
                    var setting &#x3D; &#123;
                        view:&#123;
                            addDiyDom: myAddDiyDom
                        &#125;,
                        data: &#123;
                            key:&#123;
                                url: &quot;nothing&quot;, &#x2F;&#x2F; url值改为不存在的属性名，则点击页面响应菜单时不会跳转
                            &#125;
                        &#125;
                    &#125;;

                    &#x2F;&#x2F; 3.从响应体中获取用来生成树形结构的JSON数据
                    var zNodes &#x3D; resp.data;

                    &#x2F;&#x2F; 4.初始化树形结构
                    $.fn.zTree.init($(&quot;#treeDemo&quot;), setting, zNodes);
                &#125;
                if (result &#x3D;&#x3D;&#x3D; &quot;FAILED&quot;) &#123;
                    layer.msg(resp.message);
                &#125;
            &#125;,
        &#125;);

    &#125;)
&lt;&#x2F;script&gt;</code></pre></li><li><p>新建 my-menu.js 文件</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">myAddDiyDom</span><span class="token punctuation">(</span><span class="token parameter">treeId<span class="token punctuation">,</span> treeNode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">// treeId是整个树形结构附着的ul标签的id</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"treeId="</span><span class="token operator">+</span>treeId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 当前树形节点的全部数据、</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>treeNode<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*    zTree 生成 id 的规则
    例子： treeDemo_7_ico
    解析： ul 标签的 id_当前节点的序号_功能
    提示： “ul 标签的 id_当前节点的序号” 部分可以通过访问 treeNode 的 tId 属性得到
    根据 id 的生成规则拼接出来 span 标签的 id
*/</span>
    <span class="token keyword">var</span> spanId <span class="token operator">=</span> treeNode<span class="token punctuation">.</span>tId <span class="token operator">+</span> <span class="token string">"_ico"</span><span class="token punctuation">;</span>

    <span class="token comment">// 根据控制图标的span标签的id找到这个span标签</span>
    <span class="token comment">// 删除旧的class</span>
    <span class="token comment">// 添加新的class</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#"</span><span class="token operator">+</span>spanId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span>treeNode<span class="token punctuation">.</span>icon<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre></li><li><p>menu-page.jsp头部引入</p><pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;html lang&#x3D;&quot;zh-CN&quot;&gt;
&lt;%@include file&#x3D;&quot;include-head.jsp&quot; %&gt;
&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;ztree&#x2F;zTreeStyle.css&quot;&#x2F;&gt;
&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;ztree&#x2F;jquery.ztree.all-3.5.min.js&quot;&gt;&lt;&#x2F;script&gt;
&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;js&#x2F;my-menu.js&quot;&gt;&lt;&#x2F;script&gt;</code></pre></li></ol><h3 id="5-1-5-动态效果"><a href="#5-1-5-动态效果" class="headerlink" title="5.1.5 动态效果"></a>5.1.5 动态效果</h3><ol><li><p>说明</p><ul><li>鼠标移到节点上时，显示对应节点拥有权限的按钮（增删等）</li><li>鼠标移开时自动消失</li></ul></li><li><p>my-menu.js中添加函数</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">// 鼠标移入节点范围时添加按钮组</span>
<span class="token keyword">function</span> <span class="token function">myAddHoverDom</span><span class="token punctuation">(</span><span class="token parameter">treeId<span class="token punctuation">,</span> treeNode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">// 按钮组的标签结构： &lt;span>&lt;a>&lt;i>&lt;/i>&lt;/a>&lt;a>&lt;i>&lt;/i>&lt;/a>&lt;/span></span>
    <span class="token comment">// 按钮组出现的位置： 节点中 treeDemo_n_a 超链接的后面</span>

    <span class="token comment">// 为了在需要移除按钮组的时候能够精确定位到按钮组所在 span， 需要给 span 设置有规律的 id</span>
    <span class="token keyword">var</span> btnGroupId <span class="token operator">=</span> treeNode<span class="token punctuation">.</span>tId <span class="token operator">+</span> <span class="token string">"_btnGrp"</span><span class="token punctuation">;</span>
    <span class="token comment">// 判断一下以前是否已经添加了按钮组</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#"</span><span class="token operator">+</span>btnGroupId<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">var</span> addBtn <span class="token operator">=</span> <span class="token string">"&lt;a id='"</span><span class="token operator">+</span>treeNode<span class="token punctuation">.</span>id<span class="token operator">+</span><span class="token string">"' class='btn btn-info dropdown-toggle btn-xs' style='margin-left:10px;padding-top:0px;' href='#' title='添加子节点'>&amp;nbsp;&amp;nbsp;&lt;i class='fa fa-fw fa-plus rbg '>&lt;/i>&lt;/a>"</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> removeBtn <span class="token operator">=</span> <span class="token string">"&lt;a id='"</span><span class="token operator">+</span>treeNode<span class="token punctuation">.</span>id<span class="token operator">+</span><span class="token string">"' class='btn btn-info dropdown-toggle btn-xs' style='margin-left:10px;padding-top:0px;' href='#' title=' 删 除 节 点 '>&amp;nbsp;&amp;nbsp;&lt;i class='fa fa-fw fa-times rbg '>&lt;/i>&lt;/a>"</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> editBtn <span class="token operator">=</span> <span class="token string">"&lt;a id='"</span><span class="token operator">+</span>treeNode<span class="token punctuation">.</span>id<span class="token operator">+</span><span class="token string">"' class='btn btn-info dropdown-toggle btn-xs' style='margin-left:10px;padding-top:0px;' href='#' title=' 修 改 节 点 '>&amp;nbsp;&amp;nbsp;&lt;i class='fa fa-fw fa-edit rbg '>&lt;/i>&lt;/a>"</span><span class="token punctuation">;</span>

    <span class="token comment">// 获取当前节点的级别数据</span>
    <span class="token keyword">var</span> level <span class="token operator">=</span> treeNode<span class="token punctuation">.</span>level<span class="token punctuation">;</span>
    <span class="token comment">// 声明变量存储拼装好的按钮代码</span>
    <span class="token keyword">var</span> btnHTML <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token comment">// 判断当前节点的级别</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>level <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 级别为 0 时是根节点， 只能添加子节点</span>
        btnHTML <span class="token operator">=</span> addBtn<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>level <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 级别为 1 时是分支节点， 可以添加子节点、 修改</span>
        btnHTML <span class="token operator">=</span> addBtn <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> editBtn<span class="token punctuation">;</span>
        <span class="token comment">// 获取当前节点的子节点数量</span>
        <span class="token keyword">var</span> length <span class="token operator">=</span> treeNode<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token comment">// 如果没有子节点， 可以删除</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            btnHTML <span class="token operator">=</span> btnHTML <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> removeBtn<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>level <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 级别为 2 时是叶子节点， 可以修改、 删除</span>
        btnHTML <span class="token operator">=</span> editBtn <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> removeBtn<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// 找到附着按钮组的超链接</span>
    <span class="token keyword">var</span> anchorId <span class="token operator">=</span> treeNode<span class="token punctuation">.</span>tId <span class="token operator">+</span> <span class="token string">"_a"</span><span class="token punctuation">;</span>
    <span class="token comment">// 执行在超链接后面附加 span 元素的操作</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#"</span><span class="token operator">+</span>anchorId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token string">"&lt;span id='"</span><span class="token operator">+</span>btnGroupId<span class="token operator">+</span><span class="token string">"'>"</span><span class="token operator">+</span>btnHTML<span class="token operator">+</span><span class="token string">"&lt;/span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 鼠标离开节点范围时删除按钮组</span>
<span class="token keyword">function</span> <span class="token function">myRemoveHoverDom</span><span class="token punctuation">(</span><span class="token parameter">treeId<span class="token punctuation">,</span> treeNode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">// 拼接按钮组的 id</span>
    <span class="token keyword">var</span> btnGroupId <span class="token operator">=</span> treeNode<span class="token punctuation">.</span>tId <span class="token operator">+</span> <span class="token string">"_btnGrp"</span><span class="token punctuation">;</span>
    <span class="token comment">// 移除对应的元素</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#"</span><span class="token operator">+</span>btnGroupId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre></li><li><p>menu-page.jsp中调用</p><pre class="language-js" data-language="js"><code class="language-js">    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        url<span class="token operator">:</span> <span class="token string">"menu/get/whole/tree.do"</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">"post"</span><span class="token punctuation">,</span>
        dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> result <span class="token operator">=</span> resp<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token string">"SUCCESS"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

                <span class="token comment">// 2.创建json对象用于存储对zTree所做的设置</span>
                <span class="token keyword">var</span> setting <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                    view<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                        addDiyDom<span class="token operator">:</span> myAddDiyDom<span class="token punctuation">,</span>
                        addHoverDom<span class="token operator">:</span> myAddHoverDom<span class="token punctuation">,</span>
                        removeHoverDom<span class="token operator">:</span> myRemoveHoverDom
                    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                    data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                        key<span class="token operator">:</span><span class="token punctuation">&#123;</span>
                            url<span class="token operator">:</span> <span class="token string">"nothing"</span><span class="token punctuation">,</span> <span class="token comment">// url值改为不存在的属性名，则点击页面响应菜单时不会跳转</span>
                        <span class="token punctuation">&#125;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

                <span class="token comment">// 3.从响应体中获取用来生成树形结构的JSON数据</span>
                <span class="token keyword">var</span> zNodes <span class="token operator">=</span> resp<span class="token punctuation">.</span>data<span class="token punctuation">;</span>

                <span class="token comment">// 4.初始化树形结构</span>
                $<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>zTree<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#treeDemo"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> setting<span class="token punctuation">,</span> zNodes<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token string">"FAILED"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span>

### <span class="token number">5.1</span><span class="token number">.6</span> 封装
<span class="token number">1.</span> 将 menu<span class="token operator">-</span>page<span class="token punctuation">.</span>jsp 中的js代码封装到my<span class="token operator">-</span>role<span class="token punctuation">.</span>js的函数中
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span>`js
    <span class="token comment">// 生成树形结构的函数</span>
    <span class="token keyword">function</span> <span class="token function">generateTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 1.准备生成树形结构的JSON数据，数据来源是发送Ajax请求得到</span>
        $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            url<span class="token operator">:</span> <span class="token string">"menu/get/whole/tree.do"</span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">"post"</span><span class="token punctuation">,</span>
            dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">var</span> result <span class="token operator">=</span> resp<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token string">"SUCCESS"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

                    <span class="token comment">// 2.创建json对象用于存储对zTree所做的设置</span>
                    <span class="token keyword">var</span> setting <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                        view<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                            addDiyDom<span class="token operator">:</span> myAddDiyDom<span class="token punctuation">,</span>
                            addHoverDom<span class="token operator">:</span> myAddHoverDom<span class="token punctuation">,</span>
                            removeHoverDom<span class="token operator">:</span> myRemoveHoverDom
                        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                        data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                            key<span class="token operator">:</span><span class="token punctuation">&#123;</span>
                                url<span class="token operator">:</span> <span class="token string">"nothing"</span><span class="token punctuation">,</span> <span class="token comment">// url值改为不存在的属性名，则点击页面响应菜单时不会跳转</span>
                            <span class="token punctuation">&#125;</span>
                        <span class="token punctuation">&#125;</span>
                    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

                    <span class="token comment">// 3.从响应体中获取用来生成树形结构的JSON数据</span>
                    <span class="token keyword">var</span> zNodes <span class="token operator">=</span> resp<span class="token punctuation">.</span>data<span class="token punctuation">;</span>

                    <span class="token comment">// 4.初始化树形结构</span>
                    $<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>zTree<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#treeDemo"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> setting<span class="token punctuation">,</span> zNodes<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token string">"FAILED"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span></code></pre></li><li><p>在 menu-page.jsp 中调用</p><pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;
    $(function ()&#123;

        &#x2F;&#x2F; 调用专门封装好的函数初始化树形结构
        generateTree();
    &#125;)
&lt;&#x2F;script&gt;</code></pre></li></ol><h2 id="5-2-添加子节点"><a href="#5-2-添加子节点" class="headerlink" title="5.2 添加子节点"></a>5.2 添加子节点</h2><h3 id="5-2-1-目标思路"><a href="#5-2-1-目标思路" class="headerlink" title="5.2.1 目标思路"></a>5.2.1 目标思路</h3><ol><li>给当前节点添加子节点， 保存到数据库并刷新树形结构的显示，仍通过模态框来实现</li><li>思路<br><img src="https://raw.githubusercontent.com/JabinHao/mihs/master/blog/crowd_funding/5-2-1.png" srcset="/img/loading.gif" alt="图片：添加子节点-思路"><h3 id="5-2-2-前端代码"><a href="#5-2-2-前端代码" class="headerlink" title="5.2.2 前端代码"></a>5.2.2 前端代码</h3></li><li>my-role.js：给按钮加上class<pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> addBtn <span class="token operator">=</span> <span class="token string">"&lt;a id='"</span><span class="token operator">+</span>treeNode<span class="token punctuation">.</span>id<span class="token operator">+</span><span class="token string">"' class='addBtn btn btn-info dropdown-toggle btn-xs' style='margin-left:10px;padding-top:0px;' href='#' title='添加子节点'>&amp;nbsp;&amp;nbsp;&lt;i class='fa fa-fw fa-plus rbg '>&lt;/i>&lt;/a>"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> removeBtn <span class="token operator">=</span> <span class="token string">"&lt;a id='"</span><span class="token operator">+</span>treeNode<span class="token punctuation">.</span>id<span class="token operator">+</span><span class="token string">"' class='removeBtn btn btn-info dropdown-toggle btn-xs' style='margin-left:10px;padding-top:0px;' href='#' title=' 删 除 节 点 '>&amp;nbsp;&amp;nbsp;&lt;i class='fa fa-fw fa-times rbg '>&lt;/i>&lt;/a>"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> editBtn <span class="token operator">=</span> <span class="token string">"&lt;a id='"</span><span class="token operator">+</span>treeNode<span class="token punctuation">.</span>id<span class="token operator">+</span><span class="token string">"' class='editBtn btn btn-info dropdown-toggle btn-xs' style='margin-left:10px;padding-top:0px;' href='#' title=' 修 改 节 点 '>&amp;nbsp;&amp;nbsp;&lt;i class='fafa-fw fa-edit rbg '>&lt;/i>&lt;/a>"</span><span class="token punctuation">;</span></code></pre></li><li>新建文件 modal-menu-add.jsp<pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;%@ page contentType&#x3D;&quot;text&#x2F;html;charset&#x3D;UTF-8&quot; language&#x3D;&quot;java&quot; %&gt;
&lt;div id&#x3D;&quot;menuAddModal&quot; class&#x3D;&quot;modal fade&quot; tabindex&#x3D;&quot;-1&quot; role&#x3D;&quot;dialog&quot;&gt;
    &lt;div class&#x3D;&quot;modal-dialog&quot; role&#x3D;&quot;document&quot;&gt;
        &lt;div class&#x3D;&quot;modal-content&quot;&gt;
            &lt;div class&#x3D;&quot;modal-header&quot;&gt;
                &lt;button type&#x3D;&quot;button&quot; class&#x3D;&quot;close&quot; data-dismiss&#x3D;&quot;modal&quot;
                        aria-label&#x3D;&quot;Close&quot;&gt;
                    &lt;span aria-hidden&#x3D;&quot;true&quot;&gt;&amp;times;&lt;&#x2F;span&gt;
                &lt;&#x2F;button&gt;
                &lt;h4 class&#x3D;&quot;modal-title&quot;&gt;尚筹网系统弹窗&lt;&#x2F;h4&gt;
            &lt;&#x2F;div&gt;
            &lt;form&gt;
                &lt;div class&#x3D;&quot;modal-body&quot;&gt;
                    请输入节点名称：&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;name&quot; &#x2F;&gt;&lt;br &#x2F;&gt;
                    请输入URL地址：&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;url&quot; &#x2F;&gt;&lt;br &#x2F;&gt;
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-th-list&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-th-list&quot; &#x2F;&gt;&amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-dashboard&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-dashboard&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon glyphicon-tasks&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon glyphicon-tasks&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-user&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-user&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-king&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-king&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-lock&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-lock&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-ok&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-ok&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-check&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-check&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-th-large&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-th-large&quot; &#x2F;&gt; &lt;br &#x2F;&gt;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-picture&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-picture&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-equalizer&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-equalizer&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-random&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-random&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-hdd&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-hdd&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-comment&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-comment&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-list&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-list&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-tags&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-tags&quot; &#x2F;&gt; &amp;nbsp;

                    &lt;i class&#x3D;&quot;glyphicon glyphicon-list-alt&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-list-alt&quot; &#x2F;&gt; &amp;nbsp;
                    &lt;br &#x2F;&gt;

                &lt;&#x2F;div&gt;
                &lt;div class&#x3D;&quot;modal-footer&quot;&gt;
                    &lt;button id&#x3D;&quot;menuSaveBtn&quot; type&#x3D;&quot;button&quot; class&#x3D;&quot;btn btn-default&quot;&gt;&lt;i class&#x3D;&quot;glyphicon glyphicon-plus&quot;&gt;&lt;&#x2F;i&gt; 保存&lt;&#x2F;button&gt;
                    &lt;button id&#x3D;&quot;menuResetBtn&quot; type&#x3D;&quot;reset&quot; class&#x3D;&quot;btn btn-primary&quot;&gt;&lt;i class&#x3D;&quot;glyphicon glyphicon-refresh&quot;&gt;&lt;&#x2F;i&gt; 重置&lt;&#x2F;button&gt;
                &lt;&#x2F;div&gt;
            &lt;&#x2F;form&gt;
        &lt;&#x2F;div&gt;
    &lt;&#x2F;div&gt;
&lt;&#x2F;div&gt;</code></pre></li><li>menu-page.jsp 中给按钮绑定单击响应函数<pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;
    $(function ()&#123;

        &#x2F;&#x2F; 调用专门封装好的函数初始化树形结构
        generateTree();

        &#x2F;&#x2F; 给添加子节点按钮绑定单击响应函数
        $(&quot;#treeDemo&quot;).on(&quot;click&quot;,&quot;.addBtn&quot;,function()&#123;

            &#x2F;&#x2F; 将当前节点的id，作为新节点的pid保存到全局变量
            window.pid &#x3D; this.id;

            &#x2F;&#x2F; 打开模态框
            $(&quot;#menuAddModal&quot;).modal(&quot;show&quot;);

            return false;
        &#125;);

        &#x2F;&#x2F; 给添加子节点的模态框中的保存按钮绑定单击响应函数
        $(&quot;#menuSaveBtn&quot;).click(function()&#123;

            &#x2F;&#x2F; 收集表单项中用户输入的数据
            var name &#x3D; $.trim($(&quot;#menuAddModal [name&#x3D;name]&quot;).val());
            var url &#x3D; $.trim($(&quot;#menuAddModal [name&#x3D;url]&quot;).val());

            &#x2F;&#x2F; 单选按钮要定位到“被选中”的那一个(没有checked则会选择第一个)
            var icon &#x3D; $(&quot;#menuAddModal [name&#x3D;icon]:checked&quot;).val();

            &#x2F;&#x2F; 发送Ajax请求
            $.ajax(&#123;
                &quot;url&quot;:&quot;menu&#x2F;save.do&quot;,
                &quot;type&quot;:&quot;post&quot;,
                &quot;data&quot;:&#123;
                    &quot;pid&quot;: window.pid,
                    &quot;name&quot;:name,
                    &quot;url&quot;:url,
                    &quot;icon&quot;:icon
                &#125;,
                &quot;dataType&quot;:&quot;json&quot;,
                &quot;success&quot;:function(response)&#123;
                    var result &#x3D; response.result;

                    if(result &#x3D;&#x3D; &quot;SUCCESS&quot;) &#123;
                        layer.msg(&quot;操作成功！&quot;);

                        &#x2F;&#x2F; 重新加载树形结构，注意：要在确认服务器端完成保存操作后再刷新
                        &#x2F;&#x2F; 否则有可能刷新不到最新的数据，因为这里是异步的
                        generateTree();
                    &#125;

                    if(result &#x3D;&#x3D; &quot;FAILED&quot;) &#123;
                        layer.msg(&quot;操作失败！&quot;+response.message);
                    &#125;
                &#125;,
                &quot;error&quot;:function(response)&#123;
                    layer.msg(response.status+&quot; &quot;+response.statusText);
                &#125;
            &#125;);

            &#x2F;&#x2F; 关闭模态框
            $(&quot;#menuAddModal&quot;).modal(&quot;hide&quot;);

            &#x2F;&#x2F; 清空表单
            &#x2F;&#x2F; jQuery对象调用click()函数，里面不传任何参数，相当于用户点击了一下
            $(&quot;#menuResetBtn&quot;).click();
        &#125;);

    &#125;)
&lt;&#x2F;script&gt;</code></pre></li><li>menu-page.jsp 页面引入模态框<pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;%@include file&#x3D;&quot;&#x2F;WEB-INF&#x2F;modal-menu-add.jsp&quot;%&gt;
&lt;%@include file&#x3D;&quot;&#x2F;WEB-INF&#x2F;modal-menu-edit.jsp&quot;%&gt;
&lt;%@include file&#x3D;&quot;&#x2F;WEB-INF&#x2F;modal-menu-confirm.jsp&quot;%&gt;
&lt;&#x2F;body&gt;</code></pre></li></ol><h3 id="5-2-3-后端代码"><a href="#5-2-3-后端代码" class="headerlink" title="5.2.3 后端代码"></a>5.2.3 后端代码</h3><ol><li><p>handler</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/menu/save.do"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResultEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">saveMenu</span><span class="token punctuation">(</span><span class="token class-name">Menu</span> menu<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    menuService<span class="token punctuation">.</span><span class="token function">saveMenu</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">ResultEntity</span><span class="token punctuation">.</span><span class="token function">successWithoutData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre></li><li><p>service</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">void</span> <span class="token function">saveMenu</span><span class="token punctuation">(</span><span class="token class-name">Menu</span> menu<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveMenu</span><span class="token punctuation">(</span><span class="token class-name">Menu</span> menu<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    menuMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre></li></ol><h2 id="5-3-更新节点"><a href="#5-3-更新节点" class="headerlink" title="5.3 更新节点"></a>5.3 更新节点</h2><h3 id="5-3-1-目标思路"><a href="#5-3-1-目标思路" class="headerlink" title="5.3.1 目标思路"></a>5.3.1 目标思路</h3><ol><li>目标：修改当前节点的基本属性。 不更换父节点。</li><li>思路<br><img src="https://raw.githubusercontent.com/JabinHao/mihs/master/blog/crowd_funding/5-3-1.png" srcset="/img/loading.gif"></li></ol><h3 id="5-3-1-前端代码"><a href="#5-3-1-前端代码" class="headerlink" title="5.3.1 前端代码"></a>5.3.1 前端代码</h3><ol><li>menu-page.jsp绑定单击响应函数<pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">// 给编辑按钮绑定单击响应函数</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#treeDemo"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span><span class="token string">".editBtn"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>

    <span class="token comment">// 将当前节点的id保存到全局变量</span>
    window<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>

    <span class="token comment">// 打开模态框</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menuEditModal"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modal</span><span class="token punctuation">(</span><span class="token string">"show"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 获取zTreeObj对象</span>
    <span class="token keyword">var</span> zTreeObj <span class="token operator">=</span> $<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>zTree<span class="token punctuation">.</span><span class="token function">getZTreeObj</span><span class="token punctuation">(</span><span class="token string">"treeDemo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 根据id属性查询节点对象</span>
    <span class="token comment">// 用来搜索节点的属性名</span>
    <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">;</span>

    <span class="token comment">// 用来搜索节点的属性值</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> window<span class="token punctuation">.</span>id<span class="token punctuation">;</span>

    <span class="token keyword">var</span> currentNode <span class="token operator">=</span> zTreeObj<span class="token punctuation">.</span><span class="token function">getNodeByParam</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 回显表单数据</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menuEditModal [name=name]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span>currentNode<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menuEditModal [name=url]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span>currentNode<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 回显radio可以这样理解：被选中的radio的value属性可以组成一个数组，</span>
    <span class="token comment">// 然后再用这个数组设置回radio，就能够把对应的值选中</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menuEditModal [name=icon]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">[</span>currentNode<span class="token punctuation">.</span>icon<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 给更新模态框中的更新按钮绑定单击响应函数</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menuEditBtn"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>

    <span class="token comment">// 收集表单数据</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menuEditModal [name=name]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menuEditModal [name=url]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> icon <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menuEditModal [name=icon]:checked"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 发送Ajax请求</span>
    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        <span class="token string">"url"</span><span class="token operator">:</span><span class="token string">"menu/update.do"</span><span class="token punctuation">,</span>
        <span class="token string">"type"</span><span class="token operator">:</span><span class="token string">"post"</span><span class="token punctuation">,</span>
        <span class="token string">"data"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
            <span class="token string">"id"</span><span class="token operator">:</span> window<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
            <span class="token string">"name"</span><span class="token operator">:</span>name<span class="token punctuation">,</span>
            <span class="token string">"url"</span><span class="token operator">:</span>url<span class="token punctuation">,</span>
            <span class="token string">"icon"</span><span class="token operator">:</span>icon
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token string">"dataType"</span><span class="token operator">:</span><span class="token string">"json"</span><span class="token punctuation">,</span>
        <span class="token string">"success"</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> result <span class="token operator">=</span> response<span class="token punctuation">.</span>result<span class="token punctuation">;</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token string">"SUCCESS"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">"操作成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 重新加载树形结构，注意：要在确认服务器端完成保存操作后再刷新</span>
                <span class="token comment">// 否则有可能刷新不到最新的数据，因为这里是异步的</span>
                <span class="token function">generateTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token string">"FAILED"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">"操作失败！"</span><span class="token operator">+</span>response<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token string">"error"</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status<span class="token operator">+</span><span class="token string">" "</span><span class="token operator">+</span>response<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 关闭模态框</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menuEditModal"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modal</span><span class="token punctuation">(</span><span class="token string">"hide"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li><li>新建 modal-edit-menu.jsp<pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;%@ page contentType&#x3D;&quot;text&#x2F;html;charset&#x3D;UTF-8&quot; language&#x3D;&quot;java&quot; %&gt;
&lt;div id&#x3D;&quot;menuEditModal&quot; class&#x3D;&quot;modal fade&quot; tabindex&#x3D;&quot;-1&quot; role&#x3D;&quot;dialog&quot;&gt;
    &lt;div class&#x3D;&quot;modal-dialog&quot; role&#x3D;&quot;document&quot;&gt;
        &lt;div class&#x3D;&quot;modal-content&quot;&gt;
            &lt;div class&#x3D;&quot;modal-header&quot;&gt;
                &lt;button type&#x3D;&quot;button&quot; class&#x3D;&quot;close&quot; data-dismiss&#x3D;&quot;modal&quot;
                    aria-label&#x3D;&quot;Close&quot;&gt;
                    &lt;span aria-hidden&#x3D;&quot;true&quot;&gt;&amp;times;&lt;&#x2F;span&gt;
                &lt;&#x2F;button&gt;
                &lt;h4 class&#x3D;&quot;modal-title&quot;&gt;尚筹网系统弹窗&lt;&#x2F;h4&gt;
            &lt;&#x2F;div&gt;
            &lt;form&gt;
                &lt;div class&#x3D;&quot;modal-body&quot;&gt;
                    请输入节点名称：&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;name&quot; &#x2F;&gt;&lt;br &#x2F;&gt;
                    请输入URL地址：&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;url&quot; &#x2F;&gt;&lt;br &#x2F;&gt;
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-th-list&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-th-list&quot; &#x2F;&gt;&amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-dashboard&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-dashboard&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon glyphicon-tasks&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon glyphicon-tasks&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-user&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-user&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-king&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-king&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-lock&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-lock&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-ok&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-ok&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-check&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-check&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-th-large&quot;&gt;&lt;&#x2F;i&gt;
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-th-large&quot; &#x2F;&gt; &lt;br &#x2F;&gt; 
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-picture&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-picture&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-equalizer&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-equalizer&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-random&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-random&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-hdd&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-hdd&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-comment&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-comment&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-list&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-list&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-tags&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-tags&quot; &#x2F;&gt; &amp;nbsp;
                    
                    &lt;i class&#x3D;&quot;glyphicon glyphicon-list-alt&quot;&gt;&lt;&#x2F;i&gt; 
                    &lt;input type&#x3D;&quot;radio&quot; name&#x3D;&quot;icon&quot; value&#x3D;&quot;glyphicon glyphicon-list-alt&quot; &#x2F;&gt; &amp;nbsp;
                    &lt;br &#x2F;&gt;
                    
                &lt;&#x2F;div&gt;
                &lt;div class&#x3D;&quot;modal-footer&quot;&gt;
                    &lt;button id&#x3D;&quot;menuEditBtn&quot; type&#x3D;&quot;button&quot; class&#x3D;&quot;btn btn-default&quot;&gt;&lt;i class&#x3D;&quot;glyphicon glyphicon-edit&quot;&gt;&lt;&#x2F;i&gt; 更新&lt;&#x2F;button&gt;
                &lt;&#x2F;div&gt;
            &lt;&#x2F;form&gt;
        &lt;&#x2F;div&gt;
    &lt;&#x2F;div&gt;
&lt;&#x2F;div&gt;</code></pre></li></ol><h3 id="5-3-2-后端代码"><a href="#5-3-2-后端代码" class="headerlink" title="5.3.2 后端代码"></a>5.3.2 后端代码</h3><ol><li>handler<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/menu/update.do"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResultEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">updateMenu</span><span class="token punctuation">(</span><span class="token class-name">Menu</span> menu<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    menuService<span class="token punctuation">.</span><span class="token function">updateMenu</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResultEntity</span><span class="token punctuation">.</span><span class="token function">successWithoutData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre></li><li>service<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">void</span> <span class="token function">updateMenu</span><span class="token punctuation">(</span><span class="token class-name">Menu</span> menu<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateMenu</span><span class="token punctuation">(</span><span class="token class-name">Menu</span> menu<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    menuMapper<span class="token punctuation">.</span><span class="token function">updateByPrimaryKeySelective</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre></li></ol><h2 id="5-4-删除节点"><a href="#5-4-删除节点" class="headerlink" title="5.4 删除节点"></a>5.4 删除节点</h2><h3 id="5-4-1-目标思路"><a href="#5-4-1-目标思路" class="headerlink" title="5.4.1 目标思路"></a>5.4.1 目标思路</h3><ol><li>目标：删除当前节点</li><li>思路<br><img src="https://raw.githubusercontent.com/JabinHao/mihs/master/blog/crowd_funding/5-4-1.png" srcset="/img/loading.gif"></li></ol><h3 id="5-4-2-前端代码"><a href="#5-4-2-前端代码" class="headerlink" title="5.4.2 前端代码"></a>5.4.2 前端代码</h3><ol><li>menu-page.jsp绑定单击响应函数<pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">// 给 "x" 按钮绑定单击响应函数</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#treeDemo"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span><span class="token string">".removeBtn"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token comment">// 将当前节点的 id 保存到全局变量</span>
    window<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token comment">// 打开模态框</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menuConfirmModal"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modal</span><span class="token punctuation">(</span><span class="token string">"show"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取 zTreeObj 对象</span>
    <span class="token keyword">var</span> zTreeObj <span class="token operator">=</span> $<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>zTree<span class="token punctuation">.</span><span class="token function">getZTreeObj</span><span class="token punctuation">(</span><span class="token string">"treeDemo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 根据 id 属性查询节点对象</span>
    <span class="token comment">// 用来搜索节点的属性名</span>
    <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">;</span>
    <span class="token comment">// 用来搜索节点的属性值</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> window<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token keyword">var</span> currentNode <span class="token operator">=</span> zTreeObj<span class="token punctuation">.</span><span class="token function">getNodeByParam</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#removeNodeSpan"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">"【&lt;i class='"</span><span class="token operator">+</span>currentNode<span class="token punctuation">.</span>icon<span class="token operator">+</span><span class="token string">"'>&lt;/i>"</span><span class="token operator">+</span>currentNode<span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">"】"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">// 给确认模态框中的 OK 按钮绑定单击响应函数</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#confirmBtn"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        <span class="token string">"url"</span><span class="token operator">:</span><span class="token string">"menu/remove.do"</span><span class="token punctuation">,</span>
        <span class="token string">"type"</span><span class="token operator">:</span><span class="token string">"post"</span><span class="token punctuation">,</span>
        <span class="token string">"data"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
            <span class="token string">"id"</span><span class="token operator">:</span>window<span class="token punctuation">.</span>id
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token string">"dataType"</span><span class="token operator">:</span><span class="token string">"json"</span><span class="token punctuation">,</span>
        <span class="token string">"success"</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> result <span class="token operator">=</span> response<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token string">"SUCCESS"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">"操作成功！ "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 重新加载树形结构， 注意： 要在确认服务器端完成保存操作后再刷新</span>
                <span class="token comment">// 否则有可能刷新不到最新的数据， 因为这里是异步的</span>
                <span class="token function">generateTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">if</span>
            <span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token string">"FAILED"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">"操作失败！ "</span><span class="token operator">+</span>response<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token string">"error"</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status<span class="token operator">+</span><span class="token string">" "</span><span class="token operator">+</span>response<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 关闭模态框</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menuConfirmModal"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modal</span><span class="token punctuation">(</span><span class="token string">"hide"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li><li>新建modal-menu-confirm.jsp文件<pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;%@ page contentType&#x3D;&quot;text&#x2F;html;charset&#x3D;UTF-8&quot; language&#x3D;&quot;java&quot; %&gt;
&lt;div id&#x3D;&quot;menuConfirmModal&quot; class&#x3D;&quot;modal fade&quot; tabindex&#x3D;&quot;-1&quot; role&#x3D;&quot;dialog&quot;&gt;
    &lt;div class&#x3D;&quot;modal-dialog&quot; role&#x3D;&quot;document&quot;&gt;
        &lt;div class&#x3D;&quot;modal-content&quot;&gt;
            &lt;div class&#x3D;&quot;modal-header&quot;&gt;
                &lt;button type&#x3D;&quot;button&quot; class&#x3D;&quot;close&quot; data-dismiss&#x3D;&quot;modal&quot;
                    aria-label&#x3D;&quot;Close&quot;&gt;
                    &lt;span aria-hidden&#x3D;&quot;true&quot;&gt;&amp;times;&lt;&#x2F;span&gt;
                &lt;&#x2F;button&gt;
                &lt;h4 class&#x3D;&quot;modal-title&quot;&gt;尚筹网系统弹窗&lt;&#x2F;h4&gt;
            &lt;&#x2F;div&gt;
            &lt;form&gt;
                &lt;div class&#x3D;&quot;modal-body&quot;&gt;
                    您真的要删除&lt;span id&#x3D;&quot;removeNodeSpan&quot;&gt;&lt;&#x2F;span&gt;这个节点吗？
                &lt;&#x2F;div&gt;
                &lt;div class&#x3D;&quot;modal-footer&quot;&gt;
                    &lt;button id&#x3D;&quot;confirmBtn&quot; type&#x3D;&quot;button&quot; class&#x3D;&quot;btn btn-danger&quot;&gt;&lt;i class&#x3D;&quot;glyphicon glyphicon-ok&quot;&gt;&lt;&#x2F;i&gt; OK&lt;&#x2F;button&gt;
                &lt;&#x2F;div&gt;
            &lt;&#x2F;form&gt;
        &lt;&#x2F;div&gt;
    &lt;&#x2F;div&gt;
&lt;&#x2F;div&gt;</code></pre></li></ol><h3 id="5-4-3-后端代码"><a href="#5-4-3-后端代码" class="headerlink" title="5.4.3 后端代码"></a>5.4.3 后端代码</h3><ol><li><p>handler</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/menu/remove.do"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResultEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">removeMenu</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    menuService<span class="token punctuation">.</span><span class="token function">removeMenu</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResultEntity</span><span class="token punctuation">.</span><span class="token function">successWithoutData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre></li><li><p>service</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">void</span> <span class="token function">removeMenu</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeMenu</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    menuMapper<span class="token punctuation">.</span><span class="token function">deleteByPrimaryKey</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre></li></ol><h2 id="5-5-RestController注解"><a href="#5-5-RestController注解" class="headerlink" title="5.5 RestController注解"></a>5.5 RestController注解</h2><h3 id="5-5-1-ResponseBody"><a href="#5-5-1-ResponseBody" class="headerlink" title="5.5.1 @ResponseBody"></a>5.5.1 @ResponseBody</h3><ol><li>MenuHandler中每个方法上都使用了<code>@ResponseBody</code>注解，所以可以把它提取到类上</li><li>代码：<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MenuHandler</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre></li></ol><h3 id="5-5-2-RestController"><a href="#5-5-2-RestController" class="headerlink" title="5.5.2 @RestController"></a>5.5.2 @RestController</h3><ol><li>可以使用 <code>@RestController</code> 注解代替上面两个注解</li><li>代码<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MenuHandler</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre></li><li>RoleController 同样</li></ol><h2 id="5-6-遇到的问题"><a href="#5-6-遇到的问题" class="headerlink" title="5.6 遇到的问题"></a>5.6 遇到的问题</h2><ol><li>乱码问题<ul><li>问题描述引入自己新建的js文件（my-role.js等）后页面显示乱码</li><li>解决方案：使用其它编辑器软件打开该文件，以 UTF-8 with BOM 格式保存</li></ul></li></ol></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/Java%E7%AC%94%E8%AE%B0/">Java笔记</a> <a class="hover-with-bg" href="/categories/Java%E7%AC%94%E8%AE%B0/%E9%A1%B9%E7%9B%AE/">项目</a> <a class="hover-with-bg" href="/categories/Java%E7%AC%94%E8%AE%B0/%E9%A1%B9%E7%9B%AE/%E5%B0%9A%E7%AD%B9%E7%BD%91/">尚筹网</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/java/">java</a> <a class="hover-with-bg" href="/tags/ssm/">ssm</a></div></div><div class="post-prevnext row"><article class="post-prev col-6"><a href="/posts/5ea5d345/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Chapter6后台管理 — 分配</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/posts/358bc598/"><span class="hidden-mobile">Chapter4后台管理 — 角色维护</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments"><div class="disqus" style="width:100%"><div id="disqus_thread"></div><script>function loadDisqus(){addCssLink("https://cdn.jsdelivr.net/npm/disqusjs@1.0/dist/disqusjs.css"),addScript("https://cdn.jsdelivr.net/npm/disqusjs@1.0/dist/disqus.js",(function(){new DisqusJS({shortname:"Jacob",apikey:""})}))}waitElementVisible("disqus_thread",loadDisqus)</script><noscript>Please enable JavaScript to view the <a target="_blank" href="https://disqus.com/?ref_noscript" rel="nofollow noopener noopener">comments powered by Disqus.</a></noscript></div></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div id="tocbot"></div></div></div></div></div></main><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><footer class="mt-5"><div class="text-center py-3"><div><a href="https://github.com/" target="_blank" rel="nofollow noopener"><span>Github</span></a> <i class="iconfont icon-love"></i> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a></div><div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div></div><div><span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("10/06/2020 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站安全运行&nbsp"+dnum+"&nbsp天",document.getElementById("times").innerHTML=hnum+"&nbsp小时&nbsp"+mnum+"&nbsp分&nbsp"+snum+"&nbsp秒"}setInterval("createtime()",250)</script></div></div></footer><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script><script src="/js/debouncer.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script><script src="/js/clipboard-use.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js"></script><script>$(document).ready((function(){var t=$("#board-ctn").offset().top;tocbot.init({tocSelector:"#tocbot",contentSelector:"#post-body",headingSelector:"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:3,scrollSmooth:!0,headingsOffset:-t}),$(".toc-list-item").length>0&&$("#toc").css("visibility","visible")}))</script><script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script><script>var typed=new Typed("#subtitle",{strings:["  ","Chapter5后台管理 — 菜单维护&nbsp;"],cursorChar:"|",typeSpeed:90,loop:!0});typed.stop(),$(document).ready((function(){$(".typed-cursor").addClass("h2"),typed.start()}))</script><script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script><script>anchors.options={placement:"right",visible:"hover"};var el="h1,h2,h3,h4,h5,h6".split(","),res=[];for(item of el)res.push(".markdown-body > "+item);anchors.add(res.join(", "))</script><script src="/js/local-search.js"></script><script>var path="/local-search.xml",inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){searchFunc(path,"local-search-input","local-search-result"),this.onclick=null}</script><script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><script>$("#post img:not(.no-zoom img, img[no-zoom]), img[zoom]").each((function(){var t=document.createElement("a");$(t).attr("data-fancybox","images"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)}))</script></body></html>